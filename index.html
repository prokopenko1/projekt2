<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="shortcut icon" href="img/favicon.png" type="image/png">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
  <!-- CSS only -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
  <!-- JavaScript Bundle with Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js" integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous"></script>

  <link rel="stylesheet" href="css/style.css">
  <title>ADVENTURES</title>
  <!-- <style>
  body {
    background: url('../img/edho1.jpg') no-repeat center top fixed;
      -webkit-background-size: cover;
      -moz-background-size: cover;
      -o-background-size: cover;
       background-size: cover;
  }
  </style> -->
</head>

<body>
  <!-- прелоадер -->
  <div class="preloader">
    <div class="preloader_image"></div>
  </div>
  <div class="container-fluid">
  <!-- навбар -->
  <nav class="header-section">
      <div class="inner-header">
          <div class="logo">
          <a href="./index.html"><img src="img/noor.png" width="120" height="50" alt=""></a>
          <div class="weatherLoc">
            <div id="city">
                <div  id="weather">
                  <img src="" id="weatherImg" >
                  <!-- <h3 class="text-center data-item" id="weather-text"></h3> -->
                </div>
                <div  id="temp">
                  <h5><span id="temp-text"></span> <span id="tempMode">&deg</span></h5>
                </div>
            </div>
          </div>
      </div>
      <div class="wrapper">
          <div class="menuToggle icon">
              <div class="hamburger"></div>
          </div>
          <ul class="menu">
            <li class="active"><a href="./index.html">Главная</a></li>
            <li><a href="./tur.html">Туры</a></li>
            <li><a href="./galery.html">Галерея</a></li>
            <li><a href="./about-us.html">О нас</a></li>
          </ul>

      </div>
      </div>
  </nav>

    <div class="row  " id="titleText">
    <div  class="col-lg-6 col-md-8 col-sm-6">
      <h1 class="dov1 fs-1  ">Экстрим туры  на любой вкус</h1>
      <p class="dov fs-5">Самые яркие впечетления на  самых отвязных лакациях</p>
      <button id="tur" type="button" class="rounded-pill text-white  " name="button"><a href="#popup1">Заказать звонок</a></button>
    </div>
    <div class="d-inline-flex align-items-end  flex-md-column  justify-content-between   col-lg-6 col-md-4 col-sm-12 " id="titleText1" >
      <div class="reww">  <a href="https://www.facebook.com/campaign/landing.php?campaign_id=1600506847&extra_1=s%7Cc%7C303881997266%7Ce%7Cfacebook%7C&placement=&creative=303881997266&keyword=facebook&partner_id=googlesem&extra_2=campaignid%3D1600506847%26adgroupid%3D60825662376%26matchtype%3De%26network%3Dg%26source%3Dnotmobile%26search_or_content%3Ds%26device%3Dc%26devicemodel%3D%26adposition%3D%26target%3D%26targetid%3Dkwd-541132862%26loc_physical_ms%3D1030351%26loc_interest_ms%3D%26feeditemid%3D%26param1%3D%26param2%3D&gclid=CjwKCAiAq8f-BRBtEiwAGr3DgXFx-euvR27SP3L67gJYU643utHO3YWwQdnrbDO1nl5IrDkz3wutnBoCY20QAvD_BwE" ><img src="img/qwe2.png" width="30" height="30"  alt=""></a></div>
      <div class="reww"><a href="./404.html"> <img src="img/qwe1.png" width="30" height="30" alt=""> </a></div>
      <div class="reww">  <a href="https://www.instagram.com/?hl=ru"> <img src="img/qwe3.png" width="30" height="30" alt=""> </a></div>
    </div>

  </div>

  </div>

  <div id="popup1" class="popup" >
  <div class="popup_body">
    <div class="left">
      <div class="login">Login</div>
      <div class="eula">Наш консультант перезвонит вам после заполнения формы</div>
    </div>

    <div class="right">
      <svg viewBox="0 0 320 300">
        <defs>
          <linearGradient
                          inkscape:collect="always"
                          id="linearGradient"
                          x1="13"
                          y1="193.49992"
                          x2="307"
                          y2="193.49992"
                          gradientUnits="userSpaceOnUse">
            <stop
                  style="stop-color:#ff9900;"
                  offset="0"
                  id="stop876" />
            <stop
                  style="stop-color:#c4ff00;"
                  offset="1"
                  id="stop878" />
          </linearGradient>
        </defs>
        <path d="m 40,120.00016 239.99984,-3.2e-4 c 0,0 24.99263,0.79932 25.00016,35.00016 0.008,34.20084 -25.00016,35 -25.00016,35 h -239.99984 c 0,-0.0205 -25,4.01348 -25,38.5 0,34.48652 25,38.5 25,38.5 h 215 c 0,0 20,-0.99604 20,-25 0,-24.00396 -20,-25 -20,-25 h -190 c 0,0 -20,1.71033 -20,25 0,24.00396 20,25 20,25 h 168.57143" />
      </svg>

      <div class="form">
        <form class="form_body" onsubmit="return checkForm()" required id="form" action="telegram.php" method="POST" >
          <label for="forName">Имя</label>
          <input type="name" id="forName" name="user_name" class="reqform_input" required  >
          <label for="formPhone">Телефон</label>
          <input type="tel" id="formPhone" name="user_phone" class="reqphoneform_input"  required >
          <input type="submit" id="submit" value="Отправить">
        </form>
      </div>
        <a href="#№" class="popup_close">Закрыть</a>
    </div>
  </div>
</div>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/animejs/2.2.0/anime.min.js'></script>
    <script  src="js/main.js"></script>
    <script>

    let inputName  = document.getElementById('forName');
    let inputPhone  = document.getElementById('formPhone');
    inputName.addEventListener("input" , function(event) {
      if (inputName.validity.typeMismatch) {
      inputName.setCustomValidity("Введите свое имя");
    } else {
      email.setCustomValidity("");
    }
    });
    function checkForm(){
      var n1= document.getElementById("forName").value;
      var templateName = /^([а-яё\s]+|[a-z\s]+)$/iu;
      if (!templateName.test(n1)) {
          alert('имя не коректно');
          return false;
      }

      return true
    }
    $(".reqphoneform_input").on('input', function(e){
      this.value = this.value.replace(/[^0-9\.]/g, '');
    });
    // форма
    var current = null;
    document.querySelector('#forName').addEventListener('focus', function(e) {
      if (current) current.pause();
      current = anime({
        targets: 'path',
        strokeDashoffset: {
          value: 0,
          duration: 700,
          easing: 'easeOutQuart'
        },
        strokeDasharray: {
          value: '240 1386',
          duration: 700,
          easing: 'easeOutQuart'
        }
      });
    });
    document.querySelector('#formPhone').addEventListener('focus', function(e) {
      if (current) current.pause();
      current = anime({
        targets: 'path',
        strokeDashoffset: {
          value: -336,
          duration: 700,
          easing: 'easeOutQuart'
        },
        strokeDasharray: {
          value: '240 1386',
          duration: 700,
          easing: 'easeOutQuart'
        }
      });
    });
    document.querySelector('#submit').addEventListener('focus', function(e) {
      if (current) current.pause();
      current = anime({
        targets: 'path',
        strokeDashoffset: {
          value: -730,
          duration: 700,
          easing: 'easeOutQuart'
        },
        strokeDasharray: {
          value: '530 1386',
          duration: 700,
          easing: 'easeOutQuart'
        }
      });
    });


    // погода
    var $tempText = $("#temp-text");
      // эта функция берет температуру из обработчика данных и отображает температуру в соответствии с правильной единицей измерения температуры, а также отображает температуру теплой или холодной.
      function formatTemperature(kelvin) {
        var cels = Math.round(kelvin - 273.15);
        //инициация индикации температуры
        $tempText.html(cels);
        var firstClick = false;
      }
      //обрабатывает данные ответа и форматирует их соответствующим образом, поскольку это асинхронный объект ответа, вся обработка и форматирование данных должны выполняться в этой функции.
      function dataHandler(data) {
        dataString = JSON.stringify(data);
        console.log(data.main.temp);
        formatTemperature(data.main.temp);
        if (data.main.temp && data.sys) {
          // отображение иконки
          if (data.weather) {
            var imgURL = "https://openweathermap.org/img/w/" + data.weather[0].icon + ".png";
            $("#weatherImg").attr("src", imgURL);
            $("#weather-text").html(data.weather[0].description);
          }
      }
    }
      function getWeather(locdata) {
        console.log("getWeather has been called.")
        var lat = locdata.latitude;
        var lon = locdata.longitude;

        var apiURI = "https://api.openweathermap.org/data/2.5/weather?lat=" + lat + "&lon=" + lon + "&lang=ru&appid=5b58aee62c41eb64fcab16edce2e5cc1";
    //выводим данные IP
        if (locdata){
          console.log("success");
          $("#city-text").html(locdata.city );
          // $("#city-text2").html(locdata.country_name);
        } else {
        console.log("fail");
        }

        //делаем запрос на данные о погоде
        console.log("success getWeather");
        console.log(apiURI);
        return $.ajax({
          url: apiURI,
          dataType: "jsonp",
          type: "GET",
          async: "true",
        }).done(dataHandler);

      }

      var counter = 0;
      function getLocation() {
        console.log("Update# " + counter++);
        //делаем запрос на локализацию устройства
        return $.ajax({
          url: "https://ipapi.co/jsonp/",
          dataType: "jsonp",
          type: "GET",
          async: "true",
        });
      }
      var updateInterval = setInterval(getLocation().done(getWeather), 300000);

    </script>

</body>
</html>
